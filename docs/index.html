<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Авиакомпания: регистрация и бронирование</title>
  <link rel="stylesheet" href="style2.css"/>
</head>
<body>
  <div class="bg-glow"></div>

  <header class="topbar">
    <button id="langBtn" class="chip" type="button">EN</button>
  </header>

  <main class="wrap">
    <h1 class="title" data-i18n="title">Авиакомпания: регистрация и бронирование</h1>

    <!-- 1. Telegram -->
    <section class="card">
      <h2 class="card-title" data-i18n="tg_title">1. Подтверждение через Telegram</h2>

      <div class="row">
        <label class="field">
          <span class="label" data-i18n="tg_label">Telegram @username</span>
          <input id="tgUsername" class="input" placeholder="@username" autocomplete="off"/>
          <small class="hint" data-i18n="tg_hint">Если ты в Telegram WebApp — я подхвачу username автоматически.</small>
        </label>

        <button id="btnGetRegCode" class="btn btn-primary" type="button" data-i18n="btn_get_code">
          Получить код
        </button>
      </div>

      <div class="muted">
        <span data-i18n="tg_info_1">Сначала открой бота и нажми</span> <b>/start</b>.
        <span data-i18n="tg_info_2">Иначе он не сможет писать тебе коды.</span>
      </div>
    </section>

    <!-- 2. Registration -->
    <section class="card">
      <h2 class="card-title" data-i18n="reg_title">2. Регистрация пассажира</h2>

      <div class="grid3">
        <label class="field">
          <span class="label" data-i18n="last_name">Фамилия</span>
          <input id="lastName" class="input" placeholder="Ivanov / Иванов"/>
        </label>
        <label class="field">
          <span class="label" data-i18n="first_name">Имя</span>
          <input id="firstName" class="input" placeholder="Petr / Пётр"/>
        </label>
        <label class="field">
          <span class="label" data-i18n="middle_name">Отчество</span>
          <input id="middleName" class="input" placeholder="Nikolaevich / Николаевич"/>
        </label>
      </div>

      <div class="grid2">
        <label class="field">
          <span class="label" data-i18n="passport">Серия и номер паспорта</span>
          <input id="passportNo" class="input" placeholder="MP1234567"/>
        </label>
        <label class="field">
          <span class="label" data-i18n="birth_date">Дата рождения</span>
          <input id="birthDate" class="input" type="date"/>
        </label>
      </div>

      <div class="grid2">
        <label class="field">
          <span class="label" data-i18n="phone">Телефон</span>
          <input id="phone" class="input" placeholder="+375XXXXXXXXX"/>
        </label>
        <label class="field">
          <span class="label" data-i18n="email">E-mail</span>
          <input id="email" class="input" placeholder="example@mail.com"/>
        </label>
      </div>

      <div class="row">
        <label class="field">
          <span class="label" data-i18n="reg_code">Код из Telegram (регистрация)</span>
          <input id="regCode" class="input" inputmode="numeric" maxlength="6" placeholder="000000"/>
        </label>

        <button id="btnRegister" class="btn btn-primary" type="button" data-i18n="btn_finish_reg">
          Завершить регистрацию
        </button>
      </div>

      <div id="regOk" class="ok hidden" data-i18n="reg_ok">✅ Регистрация завершена. Можно бронировать рейсы.</div>
    </section>

    <!-- 3. Booking -->
    <section id="bookingCard" class="card hidden">
      <h2 class="card-title" data-i18n="book_title">3. Бронирование</h2>

      <div class="grid2">
        <label class="field">
          <span class="label" data-i18n="flight">Рейс</span>
          <select id="flightSelect" class="input"></select>
          <small class="hint" id="flightMeta"></small>
        </label>

        <label class="field">
          <span class="label" data-i18n="price">Цена (USD)</span>
          <input id="priceUsd" class="input" type="number" step="0.01" min="1" value="199.00"/>
          <small class="hint" data-i18n="price_hint">Цена хранится в tickets.price_usd (как ты и хотел).</small>
        </label>
      </div>

      <div class="seat-wrap">
        <div class="seat-head">
          <div class="seat-title" data-i18n="seat_title">Выбор места</div>
          <button id="btnReloadSeats" class="btn btn-ghost" type="button" data-i18n="btn_reload_seats">Обновить</button>
        </div>

        <div id="seatLegend" class="legend">
          <span class="dot free"></span><span data-i18n="seat_free">свободно</span>
          <span class="dot taken"></span><span data-i18n="seat_taken">занято</span>
          <span class="dot pick"></span><span data-i18n="seat_pick">выбрано</span>
        </div>

        <div id="seats" class="seats"></div>

        <div class="row">
          <div class="muted">
            <span data-i18n="picked">Выбрано место:</span> <b id="pickedSeat">—</b>
          </div>

          <button id="btnGetBookCode" class="btn btn-primary" type="button" data-i18n="btn_get_book_code">
            Получить код для бронирования
          </button>
        </div>

        <div id="bookConfirmRow" class="row hidden">
          <label class="field">
            <span class="label" data-i18n="book_code">Код из Telegram (бронирование)</span>
            <input id="bookCode" class="input" inputmode="numeric" maxlength="6" placeholder="000000"/>
          </label>

          <button id="btnConfirmBooking" class="btn btn-primary" type="button" data-i18n="btn_confirm_booking">
            Подтвердить бронирование
          </button>
        </div>
      </div>
    </section>

    <!-- 4. My flights -->
    <section id="myFlightsCard" class="card hidden">
      <h2 class="card-title" data-i18n="my_title">Мои рейсы</h2>

      <div class="row">
        <button id="btnMyFlights" class="btn btn-primary" type="button" data-i18n="btn_my_flights">
          Показать мои рейсы
        </button>
        <div class="muted" id="whoami"></div>
      </div>

      <div id="myFlights" class="list"></div>
    </section>
  </main>

  <div id="toast" class="toast hidden"></div>

  <script src="script.js"></script>
</body>
</html>
